apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: teams-api
  description: Teams
spec:
  type: openapi
  lifecycle: production
  owner: peter
  system: teams
  description: |
    openapi: 3.0.1
    info:
      title: Teams API
      version: '0.0'
    servers:
    - url: "/teams"
    paths:
      "/api/v{version}/teams/{teamId}/members/{teamMemberId}/roles":
        put:
          tags:
          - TeamMemberRoles
          parameters:
          - name: teamId
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: teamMemberId
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: version
            in: path
            required: true
            schema:
              type: string
          requestBody:
            content:
              application/json:
                schema:
                  "$ref": "#/components/schemas/UpdateTeamMemberRolesModel"
              text/json:
                schema:
                  "$ref": "#/components/schemas/UpdateTeamMemberRolesModel"
              application/*+json:
                schema:
                  "$ref": "#/components/schemas/UpdateTeamMemberRolesModel"
            required: true
          responses:
            '200':
              description: Success
            '400':
              description: Bad Request
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
      "/api/v{version}/teams/{teamId}/members/{teamMemberId}":
        get:
          tags:
          - TeamMembers
          operationId: Get
          parameters:
          - name: teamMemberId
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: teamId
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: version
            in: path
            required: true
            schema:
              type: string
          responses:
            '200':
              description: Success
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ReadTeamMemberModel"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ReadTeamMemberModel"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ReadTeamMemberModel"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
        delete:
          tags:
          - TeamMembers
          parameters:
          - name: teamId
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: teamMemberId
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: version
            in: path
            required: true
            schema:
              type: string
          responses:
            '204':
              description: Success
            '400':
              description: Bad Request
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '404':
              description: Not Found
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
      "/api/v{version}/teams/{teamId}/members":
        get:
          tags:
          - TeamMembers
          parameters:
          - name: teamId
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: version
            in: path
            required: true
            schema:
              type: string
          responses:
            '200':
              description: Success
              content:
                text/plain:
                  schema:
                    type: array
                    items:
                      "$ref": "#/components/schemas/ReadTeamMemberModel"
                application/json:
                  schema:
                    type: array
                    items:
                      "$ref": "#/components/schemas/ReadTeamMemberModel"
                text/json:
                  schema:
                    type: array
                    items:
                      "$ref": "#/components/schemas/ReadTeamMemberModel"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
        post:
          tags:
          - TeamMembers
          parameters:
          - name: teamId
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: version
            in: path
            required: true
            schema:
              type: string
          requestBody:
            content:
              application/json:
                schema:
                  "$ref": "#/components/schemas/WriteTeamMemberModel"
              text/json:
                schema:
                  "$ref": "#/components/schemas/WriteTeamMemberModel"
              application/*+json:
                schema:
                  "$ref": "#/components/schemas/WriteTeamMemberModel"
            required: true
          responses:
            '201':
              description: Success
            '400':
              description: Bad Request
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '409':
              description: Conflict
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
      "/api/v{version}/Teams":
        get:
          tags:
          - Teams
          summary: Get all teams in the current organisation
          parameters:
          - name: version
            in: path
            required: true
            schema:
              type: string
          responses:
            '200':
              description: Success
              content:
                text/plain:
                  schema:
                    type: array
                    items:
                      "$ref": "#/components/schemas/ReadTeamModel"
                application/json:
                  schema:
                    type: array
                    items:
                      "$ref": "#/components/schemas/ReadTeamModel"
                text/json:
                  schema:
                    type: array
                    items:
                      "$ref": "#/components/schemas/ReadTeamModel"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
        post:
          tags:
          - Teams
          parameters:
          - name: version
            in: path
            required: true
            schema:
              type: string
          requestBody:
            content:
              application/json:
                schema:
                  "$ref": "#/components/schemas/WriteTeamModel"
              text/json:
                schema:
                  "$ref": "#/components/schemas/WriteTeamModel"
              application/*+json:
                schema:
                  "$ref": "#/components/schemas/WriteTeamModel"
            required: true
          responses:
            '201':
              description: Success
            '400':
              description: Bad Request
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
      "/api/v{version}/Teams/user/{userId}":
        get:
          tags:
          - Teams
          summary: Get all teams in the current organisation
          parameters:
          - name: userId
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: version
            in: path
            required: true
            schema:
              type: string
          responses:
            '200':
              description: Success
              content:
                text/plain:
                  schema:
                    type: array
                    items:
                      "$ref": "#/components/schemas/ReadTeamModel"
                application/json:
                  schema:
                    type: array
                    items:
                      "$ref": "#/components/schemas/ReadTeamModel"
                text/json:
                  schema:
                    type: array
                    items:
                      "$ref": "#/components/schemas/ReadTeamModel"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
      "/api/v{version}/Teams/{id}":
        get:
          tags:
          - Teams
          parameters:
          - name: id
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: version
            in: path
            required: true
            schema:
              type: string
          responses:
            '200':
              description: Success
            '400':
              description: Bad Request
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '404':
              description: Not Found
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
        put:
          tags:
          - Teams
          parameters:
          - name: id
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: version
            in: path
            required: true
            schema:
              type: string
          requestBody:
            content:
              application/json:
                schema:
                  "$ref": "#/components/schemas/WriteTeamModel"
              text/json:
                schema:
                  "$ref": "#/components/schemas/WriteTeamModel"
              application/*+json:
                schema:
                  "$ref": "#/components/schemas/WriteTeamModel"
            required: true
          responses:
            '200':
              description: Success
            '400':
              description: Bad Request
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '404':
              description: Not Found
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
        delete:
          tags:
          - Teams
          parameters:
          - name: id
            in: path
            required: true
            schema:
              type: string
              format: uuid
          - name: version
            in: path
            required: true
            schema:
              type: string
          responses:
            '204':
              description: Success
            '400':
              description: Bad Request
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '404':
              description: Not Found
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
      "/api/v{version}/Teams/check":
        get:
          tags:
          - Teams
          parameters:
          - name: name
            in: query
            schema:
              type: string
          - name: version
            in: path
            required: true
            schema:
              type: string
          responses:
            '200':
              description: Success
            '400':
              description: Bad Request
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
            '401':
              description: Unauthorized
              content:
                text/plain:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                application/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
                text/json:
                  schema:
                    "$ref": "#/components/schemas/ProblemDetails"
    components:
      schemas:
        OrganizationInviteStatus:
          enum:
          - 0
          - 1
          - 2
          - 3
          type: integer
          format: int32
        ProblemDetails:
          type: object
          properties:
            type:
              type: string
              nullable: true
            title:
              type: string
              nullable: true
            status:
              type: integer
              format: int32
              nullable: true
            detail:
              type: string
              nullable: true
            instance:
              type: string
              nullable: true
          additionalProperties: {}
        ReadTeamMemberModel:
          type: object
          properties:
            id:
              type: string
              format: uuid
            userEmail:
              type: string
              nullable: true
            roles:
              type: object
              additionalProperties:
                type: string
              nullable: true
            organizationInviteStatus:
              "$ref": "#/components/schemas/OrganizationInviteStatus"
          additionalProperties: false
        ReadTeamModel:
          type: object
          properties:
            id:
              type: string
              format: uuid
              readOnly: true
            name:
              type: string
              nullable: true
              readOnly: true
            lastModified:
              type: string
              format: date-time
              readOnly: true
            created:
              type: string
              format: date-time
              readOnly: true
            canEdit:
              type: boolean
              readOnly: true
          additionalProperties: false
        UpdateTeamMemberRolesModel:
          type: object
          properties:
            roles:
              type: array
              items:
                type: string
              nullable: true
          additionalProperties: false
        WriteTeamMemberModel:
          required:
          - roles
          - userEmail
          type: object
          properties:
            userEmail:
              type: string
              format: email
            roles:
              type: array
              items:
                type: string
          additionalProperties: false
        WriteTeamModel:
          type: object
          properties:
            name:
              type: string
              nullable: true
          additionalProperties: false
      securitySchemes:
        Bearer:
          type: apiKey
          description: JWT Authorization header using the Bearer scheme.
          name: Authorization
          in: header
    security:
    - Bearer: []
    tags:
    - name: Teams
      description: API for managing Teams
    
